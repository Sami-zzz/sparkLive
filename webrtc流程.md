模拟直播的场景，即房主开直播，所有用户能看到房主即可

1. getDisplayMedia 获取 stream
2. new RTCPeerConnection 得到 pc
3. 监听 pc 的 track 和 candidate 事件
4. 遍历 stream 里的 track，并插入 pc
5. 加入房间
6. pc 创建 offer，并将 offer 设置到本地描述
7. 发送 offer
   1. 接收方收到 offer 了， new RTCPeerConnection 得到 pc
   2. 将收到的 offer 设置为远程描述
   3. pc 创建 answer，并将 answer 设置到本地描述
   4. 发送 answer
   5. 注意：接收方并没有做 getDisplayMedia 等操作，这就意味着，虽然是 p2p，但是接收方可以看到发起方的画面，但是发起方看不到接收方的画面
8. 收到 anwser，将 anwser 设置到远程描述
9. 完成会议

模拟会议的场景，会议其实就没有房主概念了，所有用户都是房主，所有用户都能看到别人画面

1. getDisplayMedia 获取 stream
2. new RTCPeerConnection 得到 pc
3. 监听 pc 的 track 和 candidate 事件
4. 遍历 stream 里的 track，并插入 pc
5. 加入房间
6. pc 创建 offer，并将 offer 设置到本地描述
7. 发送 offer
   1. 接收方收到 offer 了， new RTCPeerConnection 得到 pc
   2. 将收到的 offer 设置为远程描述
   3. getDisplayMedia 获取 stream
   4. 监听 pc 的 track 和 candidate 事件
   5. 遍历 stream 里的 track，并插入 pc
   6. pc 创建 answer，并将 answer 设置到本地描述
   7. 发送 answer
   8. 注意：接收方有做 getDisplayMedia 等操作，这就意味着，双方都能拿看到画面
8. 收到 anwser，将 anwser 设置到远程描述
9. 完成会议

> https://developer.mozilla.org/zh-CN/docs/Web/API/WebRTC_API/Signaling_and_video_calling

## 注意

别被什么一对一，一对多，多对多这些东西搞混，webrtc 本质上是 p2p，即一个用户和另一个用户视频通话，就需要双方各自 new 一个 rtc；
一对一，一对多，多对多这些其实都可以抽象成多对多？

每个人的理解方式都不一样，这里我先说我自己的理解：

## 一对一场景

此时是单向的

> 需求：房主用户 a 和用户 b，两者视频通话，用户 b 可以看到房主用户 a 就可以了，房主用户 a 不需要看到用户 b
> 结果：房主用户 a 和 b 各自 new 一个 rtc 即可。

用户 b 没有使用 getDisplayMedia 等操作，意味着这可以理解是一个直播场景，用户 b 可以看到房主直播画面，但是房主看不到用户 b 的画面

假设，此时用户 b 有使用 getDisplayMedia 等操作，这就意味着这是一个会议场景，双方都可以看到对方的画面，但是，此时仍旧是一对一。或者是多对多？

按照实际的需求结果（即看到的画面）区分的话，其实是多对多？？？？
按照实际的人数区分的话，其实是一对一

## 一对多场景

一是房主，多是用户

此时是单向的

> 需求：房主用户 a 直播，用户 b,c,d 可以看到房主用户 a 直播，并且房主用户 a 不需要看用户 b,c,d 直播，而且用户 b,c,d 之间也不需要互相看
> 上述总结：所有用户（即观众）只需要看到房主直播即可
> 因此，就是房主用户 a 和用户 b 需要视频通话，双方就都需要 new 一个 rtc；其次房主用户 a 还要和用户 c 视频通话，房主用户 a 就又得 new 一个 rtc；最后房主用户 a 和用户 d 也是以此类推
> 结果：房主用户 a 自己 new 了三个 rtc，用户 b,c,d 分别 new 了一个。

一个房间内，房主监听是否有用户进入直播间，
假设有用户 b 进入直播间，房主 a 就 new 一个 rtc，然后发 offer 给用户 b，走完流程；用户 b 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
此时第二个用户 c 进来了，房主 a 继续 new 一个 rtc，然后发 offer 给用户 c，走完流程；用户 c 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
以此类推

## 多对多

此时是双向的

> 需求：房主用户 a 直播，用户 b,c,d ，每个用户都能看到当前房间所有人的画面

一个房间内，房主监听是否有用户进入直播间，
假设有用户 b 进入直播间，房主 a 就 new 一个 rtc，然后发 offer 给用户 a，走完流程；用户 b 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
此时第二个用户 c 进来了，房主 a 继续 new 一个 rtc，然后发 offer 给用户 c，走完流程；用户 c 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
注意，完成上述操作后，此时的情况是房主 a 可以看到用户 b 和用户 c，用户 b 和用户 c 并不能互相视频通话，因此需要执行以下其中一个操作：
1，用户 b 开始 new 一个 rtc，然后发 offer 给用户 c，走完流程；用户 c 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
2，用户 c 开始 new 一个 rtc，然后发 offer 给用户 b，走完流程；用户 b 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
完成上述操作之后，此时的情况就是房主 a 可以看到用户 b 和用户 c，并且用户 b 和用户 c 也能互相看到了
假设此时第三个用户 d 进来了，房主 a 继续 new 一个 rtc，然后发 offer 给用户 d，走完流程；用户 d 收到 offer 后，new 一个 rtc，然后设置远程描述，走完流程。然后完成视频通话；
注意，完成上述操作后，此时的情况是房主 a 可以看到用户 b 、用户 c、用户 d，用户 b 和用户 c 能互相视频通话，但是用户 b 不能看到用户 d，用户 c 也不能看到用户 d，用户 d 也看不到用户 b 和用户 c
此时其实可以抽象成：不在有房主的概念，每个用户都是房主，每个用户进入房间后，都给除自己以外的所有人发 offer，此时的流程是这样的：
假设房间目前只有用户 a，
1，用户 b 进入房间，用户给房间除自己以外的所有人（目前只有用户 a）发 offer，然后此时房间用户 a 和 b 都能互相看到画面

> 用户 a 有 1 个 rtc，是和用户 b 视频通话产生的；用户 b 有 1 个 rtc，是和用户 a 视频通话产生的；

2，用户 c 进入房间，用户给房间除自己以外的所有人（用户 a，用户 b）发 offer，然后此时房间用户 c 和用户 a、b 互相都能看到画面。

> 用户 a 有 2 个 rtc，是和用户 b 和 c 视频通话产生的；用户 b 有 2 个 rtc，是和用户 a 和 c 视频通话产生的；用户 c 有 2 个 rtc，是和用户 a 和 b 视频通话产生的；

3，用户 d 进入房间，用户给房间除自己以外的所有人（用户 a，用户 b，用户 c）发 offer，然后此时房间用户 c 和用户 a、b、d 互相都能看到画面。

> 用户 a 有 3 个 rtc，是和用户 b,c,d 视频通话产生的；用户 b 有 3 个 rtc，是和用户 a,c,d 视频通话产生的；用户 c 有 3 个 rtc，是和用户 a,b,d 视频通话产生的；用户 d 有 3 个 rtc，是和用户 a,b,c 视频通话产生的；
